<section class="content">
    <blockquote>
        <p>复旦微董会申请表</p>
        <small>请认真填写下面信息，我们承诺保护您的隐私，为您提供更优质的服务。请申请人认真阅读《微信群管理办法》和《联合会章程》，详细填写以下各项内容，如果以下填写信息不完整，工作组将无法吸纳您成为正式群友或会员。微信群申请通过工作组确认后将由群秘书“小数点”邀请入群；会员申请会有工作组发送确认邮件和缴费通知，收到会费之后群秘书“小数点”会邀请进入会员群。</small>
    </blockquote>
    <div class="box box-warning">
        <div class="box-header">
            <h3 class="box-title">申请成为会员</h3>
        </div>
        <label class="checkbox-inline">
            <input type="radio" name="optionsRadiosinline" id="optionsRadios1"
                   value="1" checked>个人普通会员
        </label>
        <label class="checkbox-inline">
            <input type="radio" name="optionsRadiosinline" id="optionsRadios2"
                   value="2">单位普通会员
        </label>
        <br>
        <label class="checkbox-inline">
            <input type="radio" name="optionsRadiosinline" id="optionsRadios3"
               value="3" >个人理事会员
        </label>
        <label class="checkbox-inline">
            <input type="radio" name="optionsRadiosinline" id="optionsRadios4"
                   value="4">单位理事会员
        </label>
        <div class="box-body">
            <div id="person">
              <div class="form-group">
              <label for="name">姓名</label><input type="text" class="form-control" id="name" placeholder="请输入姓名">
              </div>
            <div class="form-group">
                <label for="name">性别</label><br>
               <label class="checkbox-inline">
                        <input type="radio" name="optionsRadiosinline2" id="optionsRadios5"
                         value="0" checked>男
                </label>
                <label class="checkbox-inline">
                            <input type="radio" name="optionsRadiosinline2" id="optionsRadios6"
                        value="1"> 女
                </label>
            </div>
             <div class="form-group">
              <label for="name">手机</label><input type="text" class="form-control" id="phone" placeholder="请输入手机号">
              </div>
            <div class="form-group">
              <label for="name">邮箱</label><input type="text" class="form-control" id="email" placeholder="请输入邮箱">
              </div>
            <div class="form-group">
              <label for="name">微信ID</label><input type="text" class="form-control" id="wechat" placeholder="请输入微信">
              </div>
            <div class="form-group">
              <label for="name">通讯地址</label><input type="text" class="form-control" id="address" placeholder="请输入地址">
              </div>
                </div>
            <div id="org" style="display:none">
             <div class="form-group">
              <label for="name">公司名称</label><input type="text" class="form-control" id="company" placeholder="">
              </div>
            <div class="form-group">
              <label for="name">公司简介</label>
                <textarea class="form-control" rows="3" id="companyintro"></textarea>
              </div>
            <div class="form-group">
              <label for="name">经营范围</label>
                <textarea class="form-control" rows="3" id="companydomain"></textarea>
              </div>
             <div class="form-group">
              <label for="name">公司网址</label><input type="text" class="form-control" id="companyweb" placeholder="">
              </div>
            <div class="form-group">
              <label for="name">法人姓名</label><input type="text" class="form-control" id="companyrep" placeholder="">
              </div>
              <div class="form-group">
              <label for="name">注册地址</label><input type="text" class="form-control" id="companyloc" placeholder="">
              </div>
            <div class="form-group">
              <label for="name">所属行业</label>
                <div class="checkbox">
                    <label><input type="checkbox" value="政府" name="box" id="1">政府</label>
                </div>
                <div class="checkbox">
                     <label><input type="checkbox" value="通讯，互联网，信息技术" name="box" id="2">通讯，互联网，信息技术</label>
	            </div>
                <div class="checkbox">
                    <label><input type="checkbox" value="医疗卫生" name="box" id="3">医疗卫生</label>
                </div>
                <div class="checkbox">
                     <label><input type="checkbox" value="制造业" name="box" id="4">制造业</label>
	            </div>
                 <div class="checkbox">
                    <label><input type="checkbox" value="金融" name="box" id="5">金融</label>
                </div>
                <div class="checkbox">
                     <label><input type="checkbox" value="教育" name="box" id="6">教育</label>
	            </div>
                <div class="checkbox">
                     <label><input type="checkbox" value="other" name="box" id="check_other">其他</label>
                    <input type="text"  id="textother" placeholder="">
	            </div>
              </div>
                </div>
            <div class="form-group">
              <label for="name">推荐人1</label><input type="text" class="form-control" id="rec1" placeholder="">
              </div>
            <div class="form-group">
              <label for="name">推荐人1手机号</label><input type="text" class="form-control" id="rec1phone" placeholder="">
              </div>
             <div class="form-group">
              <label for="name">推荐人2</label><input type="text" class="form-control" id="rec2" placeholder="">
              </div>
            <div class="form-group">
              <label for="name">推荐人2手机号</label><input type="text" class="form-control" id="rec2phone" placeholder="">
              </div>

            <div class="form-group">
              <label for="name">您希望通过微董会获取哪些服务或资源？</label>
                <textarea class="form-control" rows="3" id="goal"></textarea>
              </div>
            <div class="form-group">
              <label for="name">您能为微董会提供哪些服务或资源？或者可做什么贡献</label>
                <textarea class="form-control" rows="3" id="contribution"></textarea>
              </div>
            <button type="button" class="btn btn-primary" id="btn-save" >提交</button>
        </div>
        <!-- /.box-body -->
    </div>
</section>
<script type="text/javascript">
$(function() {
     $(document).ready(function ()
         {
             $(":radio[name='optionsRadiosinline']").change(function ()
             {
                     var value=$(this).val();
                     if(value==1 || value==3){
                         $('#person').show();
                         $('#org').hide();
                     }else{
                          $('#person').hide();
                         $('#org').show();
                     }
             });
           });
    $('#btn-save').click(function() {

    var regType=$("input:radio[name='optionsRadiosinline']:checked").val();
        var sex;
        if(regType==1 || regType==3){
        if($('#name').val()==''){
            return alert('姓名不能为空')
        }
         if($('#phone').val()==''){
            return alert('手机号不能为空')
        }
         if($('#email').val()==''){
            return alert('邮箱不能为空')
        }
         if($('#wechat').val()==''){
            return alert('微信不能为空')
        }
        if($('#address').val()==''){
            return alert('地址不能为空')
        }
         sex=$("input:radio[name='optionsRadiosinline2']:checked").val();
        }
         if(regType==2 || regType==4){
          if($('#company').val()==''){
            return alert('公司名不能为空')
        }
         if($('#companyintro').val()==''){
            return alert('公司介绍不能为空')
        }
         if($('#companydomain').val()==''){
            return alert('经营范围不能为空')
        }
         if($('#companyweb').val()==''){
            return alert('网址不能为空')
        }
        if($('#companyrep').val()==''){
            return alert('法人不能为空')
        }
        var profession="";

        $(":checkbox").each(function(){
            if($(this).prop('checked')==true){
                if($(this).val()=='other'){
                    profession=profession+$('#textother').val()+",";
                }else{
                    profession=profession+$(this).val()+",";
                }
            }
         });
         }
        $.ajax({
            type: "POST",
            url: '/rest/appform',
            data: {
                regType:regType,
                fullname:$('#name').val(),
                sex:sex,
                phone:$('#phone').val(),
                email:$('#email').val(),
                address:$('#address').val(),
                wechat:$('#wechat').val(),
                company:$('#company').val(),
                companyintro:$('#companyintro').val(),
                companydomain:$('#companydomain').val(),
                companyweb:$('#companyweb').val(),
                companyrep:$('#companyrep').val(),
                companyloc:$('#companyloc').val(),
                goal: $('#goal').val(),
                contribution: $('#contribution').val(),
                profession: profession
            },
            success: function(data) {
                if (data.error) {
                    $('#btn-save').text("已提交").button("refresh");
                    $('#btn-save').attr("disabled", true);
                    return alert( data.error || '失败！');
                }
            },
            error: function() {
                alert('网络错误！');
            },
            dataType: 'json'
        });
        return false;
    });
});
</script>
<script src="http://res.wx.qq.com/open/js/jweixin-1.0.0.js"></script>
<script>
        // 自定义微信分享内容
        var _share_desc = "请认真填写下面信息，我们承诺保护您的隐私，为您提供更优质的服";
        var __wxConfig__ = {
                debug: false,
                appId: 'wxce3f1a51aa60f801',
                timestamp: '1454070038',
                nonceStr: 'DzBfeUoHEHOMbCNm',
                signature: '92c62e0ce04e5a1d803eb65b7795e5855c477fbc',
                jsApiList: ['onMenuShareTimeline','onMenuShareAppMessage', 'onMenuShareQQ', 'onMenuShareWeibo', 'hideOptionMenu', 'showOptionMenu', 'getLocation']
            },
        _shareInfo = {
                title: '复旦微董会申请表',
                desc: _share_desc||"\n麦客CRM\nMikecrm.com",
                link: "http://form.mikecrm.com/f.php?t=BuSEkw",
                imgUrl: _share_imgWeixin
            };

        // wx注入设置
        wx.config(__wxConfig__);
        wx.ready(function(){
            // config succeed function
            wx.checkJsApi({
                jsApiList: __wxConfig__.jsApiList,
                success: function(res) {
                    if(res.errMsg === 'checkJsApi:ok'){
                        //分享到朋友圈使用二级域名
                        wx.onMenuShareTimeline(_shareInfo);
                        wx.onMenuShareAppMessage(_shareInfo);
                        wx.onMenuShareQQ(_shareInfo);
                        wx.onMenuShareWeibo(_shareInfo);
                        wx.showOptionMenu();
                    } else {
                        if(document.addEventListener){
                            document.addEventListener('WeixinJSBridgeReady', function onBridgeReady() {
                                var _old_shareInfo = {
                                    "appid": "wxce3f1a51aa60f801",
                                    "title": "复旦微董会申请表",
                                    "link": "http://form.mikecrm.com/f.php?t=BuSEkw",
                                    "desc": _share_desc||"\n麦客CRM\nMikecrm.com",
                                    "img_url": _share_imgWeixin,
                                    "img_width": "640",
                                    "img_height": "640"
                                };
                                WeixinJSBridge.on('menu:share:appmessage', function(argv){
                                    WeixinJSBridge.invoke('sendAppMessage',_old_shareInfo, function(res) {
                                    });
                                });
                                WeixinJSBridge.on('menu:share:timeline', function(argv){
                                    WeixinJSBridge.invoke('shareTimeline',_old_shareInfo, function(res) {
                                    });
                                });
                                WeixinJSBridge.call('showOptionMenu');
                            },false);
                        }
                    }
                }
            });
        });

        (function(){
            var opts = {
                title: "复旦微董会申请表",
                desc: _share_desc||"\n麦客CRM\nMikecrm.com",
                img: _share_imgWeixin,
                callback: function(re) {
                }
            };
            if (typeof wsqOpenApp == 'undefined') {
                if(document.addEventListener){
                    document.addEventListener('wsqOpenAppReady', function(e) {
                        var counter = 0;
                        wsqOpenApp.initShare(opts);
                    }, false);
                }
            } else {
                var counter = 0;
                wsqOpenApp.initShare(opts);
            }

            $(window).on('__share_image_ready' , function(){
                    $('#weixinShareIco').attr('src', 'http://asset.mikecrm.com/images/logo/weixinShare@1x.png');
                    window._shareInfo.imgUrl = window._shareTimeline_imgWeixin = window._share_imgWeixin = 'http://asset.mikecrm.com/images/logo/weixinShare@1x.png';
                });
                    })();
</script>

